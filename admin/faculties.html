<!DOCTYPE html>
<html>
<head>
    <title>Faculties</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<script type="module" src="admin.js"></script>

<h1>Faculties</h1>

<form id="addForm">
    <label>Name</label><input id="name">
    <label>Courses (comma separated)</label><input id="courses">

    <button type="submit">Add Faculty</button>
</form>

<h2>Existing Faculties</h2>
<table id="dataTable"></table>

<script type="module">
import "./firestore.js";

const colRef = collection(db, "faculties");

document.getElementById("addForm").onsubmit = async (e) => {
    e.preventDefault();

    await addDoc(colRef, {
        name: name.value,
        courses: courses.value.split(",").map(x => x.trim())
    });

    location.reload();
};

async function loadData() {
    const snap = await getDocs(colRef);
    let html = "<tr><th>Name</th><th>Courses</th><th>Actions</th></tr>";

    snap.forEach(docu => {
        const d = docu.data();
        html += `
        <tr>
            <td>${d.name}</td>
            <td>${d.courses.join(", ")}</td>
            <td><button onclick="del('${docu.id}')">Delete</button></td>
        </tr>`;
    });

    document.getElementById("dataTable").innerHTML = html;
}

window.del = async (id) => {
    await deleteDoc(doc(db, "faculties", id));
    location.reload();
};

loadData();
</script>

</body>
</html>
